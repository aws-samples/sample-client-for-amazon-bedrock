name: "check-apple-services"

on:
  workflow_dispatch:

jobs:
  check-services:
    runs-on: macos-latest
    steps:
      - name: Check Apple Developer Services Status
        run: |
          echo "ğŸ” æ£€æŸ¥ Apple å¼€å‘è€…æœåŠ¡çŠ¶æ€..."
          echo "=================================="
          
          echo "ğŸ“Š å½“å‰æ—¶é—´: $(date -u '+%Y-%m-%d %H:%M:%S UTC')"
          echo ""
          
          # æ£€æŸ¥ç½‘ç»œè¿æ¥åˆ° Apple æœåŠ¡å™¨
          echo "ğŸŒ æµ‹è¯•ç½‘ç»œè¿æ¥:"
          echo "- Apple Developer: $(curl -s -o /dev/null -w '%{http_code}' https://developer.apple.com/ || echo 'Failed')"
          echo "- App Store Connect: $(curl -s -o /dev/null -w '%{http_code}' https://appstoreconnect.apple.com/ || echo 'Failed')"
          echo ""
          
          # å°è¯•è·å–å…¬è¯æœåŠ¡å“åº”æ—¶é—´
          echo "â±ï¸ å…¬è¯æœåŠ¡å“åº”æµ‹è¯•:"
          start_time=$(date +%s)
          if xcrun notarytool history --apple-id "test@example.com" --password "test" --team-id "test" 2>/dev/null; then
            echo "âœ… å…¬è¯æœåŠ¡å“åº”æ­£å¸¸"
          else
            end_time=$(date +%s)
            response_time=$((end_time - start_time))
            echo "âš ï¸ å…¬è¯æœåŠ¡å“åº”æ—¶é—´: ${response_time}ç§’ (é¢„æœŸ: <5ç§’)"
          fi
          echo ""
          
          # æ£€æŸ¥ Xcode å’Œå·¥å…·ç‰ˆæœ¬
          echo "ğŸ› ï¸ å¼€å‘å·¥å…·ç‰ˆæœ¬:"
          echo "- Xcode: $(xcode-select --version)"
          echo "- notarytool: $(xcrun notarytool --version 2>/dev/null || echo 'Not available')"
          echo "- macOS: $(sw_vers -productVersion)"
          echo ""
          
          # å»ºè®®
          echo "ğŸ’¡ å»ºè®®:"
          echo "1. æ£€æŸ¥ Apple ç³»ç»ŸçŠ¶æ€: https://developer.apple.com/system-status/"
          echo "2. å¦‚æœæœåŠ¡æ­£å¸¸ï¼Œè€ƒè™‘ä½¿ç”¨ App Store Connect API å¯†é’¥"
          echo "3. ç›‘æ§å…¬è¯é˜Ÿåˆ—ï¼Œé¿å…åœ¨é«˜å³°æœŸæäº¤"
          echo "4. è€ƒè™‘åˆ†æ‰¹æäº¤ï¼Œé¿å…åŒæ—¶æäº¤å¤šä¸ªåº”ç”¨"
